###limit formula
x <- 2
h <- .00001
(f(x+h) - f(x))/h
###limit formula
x <- 2
h <- .0000000000000000000000000000000000000000000001
(f(x+h) - f(x))/h
h <- .000000000000000000000001
(f(x+h) - f(x))/h
h <- .0000000000001
(f(x+h) - f(x))/h
h <- .0000001
(f(x+h) - f(x))/h
h <- .000001
(f(x+h) - f(x))/h
##making f prime
f_prime <- function(x) 2*x
##add to dataset
df$fpx <- f_prime(df$x)
##plot
ggplot(df, aes(x)) + geom_line(y=fx, color="f(x) = x^2")
##plot
ggplot(df, aes(x)) + geom_line(aes(y=fx, color="f(x) = x^2")) + geom_line(aes(fpx, color="f'(x)")
source("~/MathTools/MathDay3.R", echo = TRUE)
##plot
ggplot(df, aes(x)) + geom_line(aes(y=fx, color="f(x) = x^2")) + geom_line(aes(fpx, color="f'(x)"))
f1 <- function(x) 3x^3 + 2x
f1 <- function(x) (3x^3 + 2x)
f1 <- function(x) (3(x)^3 + 2x)
f_1 <- function(x) (3(x)^3 + 2x)
##plot
ggplot(df, aes(x)) + geom_line(aes(y=fx, color="f(x) = x^2")) + geom_line(aes(y=fpx, color="f'(x)=2*x")) + theme_minimal()
f_1 <- function(y) (3(y)^3 + 2y)
g <- function(y) (3(y)^3 + 2y)
g <- function(y) 3(y)^3 + 2y
h <- function(z) 2z^2 - 5z + 1
g<-function(y) 3(y)^3 + 2y
h<-function(z) 2z^2 - 5z + 1
g <- function(y) 3*(y)^3 + 2*y
h <- function(z) 2*z^2 - 5*z + 1
j <- function(x) e^x
k <- function(x) ln(x)
(g(1 + h) - g(1))/h
(g(x + h) - g(1))/h
h <- 0.000001
g <- function(x) 3*(x)^3 + 2*x
(g(x + h) - g(1))/h
(g(1 + h) - g(1))/h
(h(x + h) - h(x))/h
h <- function(x) 2*x^2 - 5*x + 1
(h(x + h) - h(x))/h
(h(2 + h) - h(2))/h
h <- 0.000001
h <- function(x) 2*x^2 - 5*x + 1
(h(2 + h) - h(2))/h
(h(2 + 0.000001) - h(2))/0.000001
j <- function(x) e^x
j <- function(x) exp()
k <- function(x) log(x)
(j(0 + 0.000001) - j(0))/0.000001
j <- function(x) exp(x)
(j(0 + 0.000001) - j(0))/0.000001
k <- function(x) log(x)
(k(2 + 0.000001)-k(2))/0.000001
h <- 0.0001
g <- function(x) 3*(x)^3 + 2*x
(g(1 + h) - g(1))/h
h <- function(x) 2*x^2 - 5*x + 1
(h(2 + 0.0001) - h(2))/0.0001
j <- function(x) exp(x)
(j(0 + 0.0001) - j(0))/0.0001
k <- function(x) log(x)
(k(2 + 0.0001)-k(2))/0.0001
5!
!(5)
factorial(5)
choose(5, 2)
#Find the derivative directly using the D function
D(g,g)
###########################################
p <- function(x)
###########################################
p <- function(x) -2*x^2 + 12x + 20
###########################################
p <- function(x) -2*x^2 + 12*x + 20
t <- 1:5
slope_approx <- (p(t+h) - P(t))/h
h <- 0.0001
slope_approx <- (p(t+h) - P(t))/h
slope_approx <- (p(t+h) - p(t))/h
h <- 0.00001
slope_approx <- (p(t+h) - p(t))/h
slope_approx
round(slope_approx)
expr <- expression(-2*x^2 + 12*x + 20)
D(expr, x)
D(expr, "x")
12 - 2 * (2 * t)
time <- seq(0,6,0.1)
df = data.frame(time,P=p(time))
df
ggplot(df, aes(time, P)) + geom_line(color="#777abc")
##Partial Derivative wrt x
D(tim, "x")
tim <- expression(x^2 + y^2)
##Partial Derivative wrt x
D(tim, "x")
##Partial Derivative wrt y
D(tim, "y")
###at point(1,2) = [2, 4]
2 * 1 = 2
library(plotly)
grid <- expand.grid(x = seq(-3, 3, length.out=30),
y = seq(-3, 3, length.out=30)) %>%
mutate(z = x^2 + y^2,
dx = 2*x
dy = 2*y)
grid <- expand.grid(x = seq(-3, 3, length.out=30),
y = seq(-3, 3, length.out=30)) %>%
mutate(z = x^2 + y^2,
dx = 2*x,
dy = 2*y)
#highlight point (1,2)
pt <- data.frame(x=1,y=2,dx=2,dy=4)
# Create 3D surface using plotly
x <- seq(-3, 3, length.out = 50)
y <- seq(-3, 3, length.out = 50)
z <- outer(x, y, function(x, y) x^2 + y^2)
plot_ly(x = ~x, y = ~y, z = ~z) %>%
add_surface(colorscale = "Viridis") %>%
layout(title = "3D Surface of f(x, y) = x^2 and y^2",
scene = list(xaxis = list(title = "x"),
yaxis = list(title = "y"),
zaxis = list(title = "f(x, y)")))
#Counting Rules
factorial(9)
factorial(0)
##little league
##selecting 9 from 12 - permutation with no repetition
factorial(12)/factorial(3)
##combination with no repetition
factorial(12)/(factorial(3)*factorial(9))
#220
choose(12, 9)
##ice cream example 4 flavors(n) and 3 scoops(r)
factorial(3+4-1)/(factorial(3)*factorial(4-1))
options(scipen=999)
factorial(16)
16*15*14
#3360
factorial(16)/factorial(13)
factorial(6)
factorial(6)*factorial(5)
choose(6, 6)
factorial(6)
#3360
factorial(16)/factorial(13)
factorial(10)/factorial(8)
rm(list=ls())
##calculate magnitude
magnitude <- sqrt(sum(v^2))
v <- c(2, -1, 3)
##calculate magnitude
magnitude <- sqrt(sum(v^2))
##calculate magnitude
magnitude <- sqrt(sum(v^2)) ; magnitude  #
##
u <- 1:2
v <- 2:3
u %*% v
sum(u*v)
u <- c(2,4)
v <- c(4,1)
u %*% v
u <- c(2,4)
v <- c(4,1)
u %*% v
u <- c(2,3)
v <- c(4,1)
u %*% v
sum(u*v)
#Calculate Magnitude
sqrt(sum(u^2)) * sqrt(sum(v^2))
##Cosine Similarity example
#Dot product is numerator
u <- 1:2
v <- 2:3
u %*% v  #Dot Product == 8
sum(u*v)  #8
#Calculate Magnitude
sqrt(sum(u^2)) * sqrt(sum(v^2))
8/8.062258
##second example cosine similarity
u <- c(3,0,1)
v <- c(6,0,2)
u %*% v
#compute magnitude
sqrt(sum(u^2)) * sqrt(sum(v^2))
#divide dot product by magnitude
20/20
movie <- read.csv("data/movie.csv")
movie <- read.csv("data/movie.csv", row.names = 1)
str(movie)
movie <- read.csv("data/movie.csv", row.names = 1)
str(movie)
sum(x*y)/(sqrt(sum(x^2))*sqrt(sum(y^2)))
##define function for cosine similarity
cosine_similarity <- function(x,y){
sum(x*y)/(sqrt(sum(x^2))*sqrt(sum(y^2)))
}
cosine_similarity(u,v)
cosine_similarity(movie["Inception", ], movie["The Matrix", ])
cosine_similarity(movie["Die Hard", ], movie["Titanic", ])
cosine_similarity(movie["The Notebook", ], movie["Titanic", ])
cosine_similarity(movie["The Notebook", ], movie["Toy Story])
cosine_similarity(movie["The Notebook", ], movie["Toy Story, ])
cosine_similarity(movie["The Notebook", ], movie["Toy Story", ])
Qreturns <- c(2, 3.5, -1, 4)
sqrt(sum(Qreturns^2))
A <- c(5,2) ; B <- c(3,-1)
A %*% B
sqrt(sum(A^2)) * sqrt(sum(B^2))
13/17.02939
A <- c(3,4) ; B <- c(6,8)
A %*% B   #13
sqrt(sum(A^2)) * sqrt(sum(B^2))  #17.02939
50/50
A <- c(3,4) ; B <- c(6,8)
A %*% B   #13
sqrt(sum(A^2)) * sqrt(sum(B^2))  #17.02939
50/50
##Identity Matrix
I <- diag(3)
##Identity Matrix
I <- diag(3), I
##Identity Matrix
I <- diag(3); I
A <- matrix(1:4, 2, 2)
A <- matrix(1:4, 2, 2, byrow = T)
A <- matrix(1:4, 2, 2, byrow = T) ; A
B <- matrix(5:8, 2, 2, byrow = T) ; B
A + B
###scalar multiplication
C <- matrix(c(2, -1, 0, 4), 2, 2, byrow = T) ; C
3*C
###Matrix multiplication
A <- matrix(c(2,1,0,3),2,2,byrow=T) ; A
B <- matrix(c(4,5),2,1) ; B
A %*% B
###Identity Matrix in Multiplication
D <- matrix(2:5, 2, 2, byrow=T)
###Identity Matrix in Multiplication
D <- matrix(2:5, 2, 2, byrow=T); D
E <- diag(2); E
D %*% E
###Transpose a matrix using t() function
F <- (1:6, 3, 2, byrow=T)
###Transpose a matrix using t() function
G <- matrix(1:6, 3, 2, byrow=T); G
t(G)
###Inverse of a matrix
H <- matrix(c(4, 7, 2, 6), 2, 2, byrow=T)
solve(H)
####Identity Matrix and Inverses
round(solve(H) %*% H, 0)
A <- matrix(c(2,0,1,3), 2, 2, byrow=T)
A <- matrix(c(2,0,1,3), 2, 2, byrow=T) ; A
B <- matrix(c(4,5),2,1)
B <- matrix(c(4,5),2,1) ; B
A %*% B
C <- matrix(c(2,1,0,6),2,2, byrow=T) ; C
D <- matrix(c(4,5),2,1, byrow=T) ; D
C %*% D
J <- matrix(c(1:6), 3, 2, byrow=T) ; J
J <- matrix(c(1:6), 3, 2) ; J
J <- matrix(c(1:6), 2, 3) ; J
K <- matrix(c(1,0,-1),3, 1) ; K
J %*% K
J <- matrix(c(1:6), 2, 3, byrow = T) ; J
K <- matrix(c(1,0,-1),3, 1) ; K
J %*% K
J <- matrix(c( 1, 2, 1, 2, 3, 3, 1, 1, 1), nrow=3, byrow=T) ; J
K <- c(6,14,18)
K <- c(6,14,18) ; K
solve(J, K)
J <- matrix(c( 1, 2, 1, 2, 3, 3, 1, 1, 1), nrow=3, byrow=T) ; J
K <- c(6,14,18) ; K
solve(J, K)
J <- matrix(c( 1, 2, 1, 2, 3, 3, 1, 1, 1), nrow=3, byrow=T) ; J
K <- c(6,14,8) ; K
solve(J, K)
M <- matrix(c(3,1,2,1,4,1,2,2,3), nrow = 3, byrow=T) ; M
N <- c(12,10,18) ; N
solve(M, N)
M <- matrix(c(2,3,-1,-4,1,2,1,-2,3), nrow = 3, byrow=T) ; M
N <- c(5,-2,6) ; N
solve(M, N)
M <- matrix(c(1, 1, 1, 2, -1, 3, 4, 2, -1), nrow = 3, byrow=T) ; M
M <- matrix(c(1, 1, 1, 2, -1, 3, 4, 2, -1), nrow = 3, byrow=T) ; M
N <- c(9,1,5) ; N
solve(M, N)
L <- matrix(c(4,2,1,3), 2, 2, byrow=T)
eigen(L)
A <- matrix(c(5,2,1,4), 2, 2, byrow=T)
eigen(A)
A <- matrix(c(5,2,1,4), 2, 2, byrow=T); A
eigen(A)
###########PCA#################
data("iris")
str(iris)
library(tidyverse)
iris_numeric <- iris %>% select(-Species)
str(iris_numeric)
iris_scaled = scale(iris_numeric)
#run the PCA with prcomp()
iris_pca <- prcomp(iris_scaled)
iris_pca
#run the PCA with prcomp()
iris_pca <- prcomp(iris_scaled(center=TRUE,scale.=TRUE))
#run the PCA with prcomp()
iris_pca <- prcomp(iris_scaled,center=TRUE,scale.=TRUE)
iris_pca
summary(iris_pca)
pcaDF <- as.data.frame(iris_pca$x)
pcaDF$Species <- iris$Species
ggplot(pcaDF, aes(PC1, PC2, color=Species)) + geom_point()
plot(iris_pca)
plot(iris_pca, type="l")
data("USArrests")
str(USArrests)
usarrests_scaled <- scale(USArrests)
pca_arrests_result <- prcomp(usarrests_scaled)
summary(pca_arrests_result)
plot(pca_arrests_result, type="1")
plot(pca_arrests_result, type="l")
simdata <- read.csv("data/sim_data.csv")
sim <- read.csv("data/sim_data.csv")
pca_sim <- prcomp(sim, scale. = T)
summary(pca_sim)
View(pcaDF)
View(pcaDF)
sim <- read.csv("data/sim_data.csv", row.names = 1)
pca_sim <- prcomp(sim, scale. = T)
summary(pca_sim)
#####Singular Value Decomposition#########
A <- matrix(c(4,5,3,2,5,4), nrow=3, byrow=T)
A
svd_result <- svd(A)
svd_result
U <- svd_result$u
U <- svd_result$u ; U
Sigma <- diag(svd_result$d)
Sigma <- diag(svd_result$d) ; Sigma
V <- svd_result$v
V <- svd_result$v ; V
install.packages("jpeg")
install.packages("imager")
library(imager)
library(jpeg)
img <- load.image("data/wren.csv")
img <- load.image("data/wren.jpg")
##convert to grayscale
gray_image <- grayscale(img)
A <- as.matrix(gray_image)
svd_result <- svd(A)
svd_result <- svd(A) ; svd_result
U_k %*% D_k %*% t(V_k)
##reconstruct image using top K singular values
reconstruct_image <- function(k){
U_k <- svd_result$u[, 1:k]
D_k <- svd_result$d[, 1:k]
V_k <- svd_result$v[, 1:k]
U_k %*% D_k %*% t(V_k)
}
##reconstruct image using top K singular values
reconstruct_image <- function(k){
U_k <- svd_result$u[, 1:k]
D_k <- svd_result$d[1:k]
V_k <- svd_result$v[, 1:k]
U_k %*% D_k %*% t(V_k)
}
for(k in c(10,50,100)) {
img_k <- reconstruct_image(k)
image(t(apply(img_k, 2, rev)), col=gray.colors(256), main=paste("k=",k), axes=FALSE)
}
##reconstruct image using top K singular values
reconstruct_image <- function(k){
U_k <- svd_result$u[, 1:k]
D_k <- svd_result$d[1:k]
V_k <- svd_result$v[, 1:k]
U_k %*% D_k %*% t(V_k)
}
par(mfrow=c(1,3)) ##1 row, 3 column output in the plot window
for(k in c(10,50,100)) {
img_k <- reconstruct_image(k)
image(t(apply(img_k, 2, rev)), col=gray.colors(256), main=paste("k=",k), axes=FALSE)
}
##reconstruct image using top K singular values
reconstruct_image <- function(k){
U_k <- svd_result$u[, 1:k]
D_k <- diag(svd_result$d[1:k])
V_k <- svd_result$v[, 1:k]
U_k %*% D_k %*% t(V_k)
}
par(mfrow=c(1,3)) ##1 row, 3 column output in the plot window
for(k in c(10,50,100)) {
img_k <- reconstruct_image(k)
image(t(apply(img_k, 2, rev)), col=gray.colors(256), main=paste("k=",k), axes=FALSE)
}
A <- matrix(c(4,5,3,2,5,4),3,2,byrow=T)
svd_A <- svd(A)
summary(A)
summary(svd_A)
U <- svd_A$u ; U
Sigma <- svd_A$d ; Sigma
V <- svd_A$v ; V
A <- c(6, -4) ; B <- c(2,5)
A %*% B
A <- matrix(c(7,-2,4,5),2,2,byrow=T)
A <- matrix(c(7,-2,4,5),2,2,byrow=T) ; A
B <- matrix(c(3,-1),1,2)
B <- matrix(c(3,-1),1,2) ; B
B <- matrix(c(3,-1)) ; B
A * B
A %*% B
A <- matrix(c(3,2,1,-2,1,4,1,7,4),3,3,byrow=T)
A <- matrix(c(3,2,1,-2,1,4,1,7,4),3,3,byrow=T) ; A
B <- c(7,1,10)
B <- c(7,1,10); B
solve(A,B)
data("diamonds")
diamonds_scaled <- scale(diamonds)
View(diamonds)
summary(diamonds)
diamonds_truncated <- diamonds %>% select(-cut,-color,-clarity)
scale(diamonds_truncated)
diamonds_scaled <- scale(diamonds_truncated)
prcomp(diamonds_scaled, scale.=T)
pca_diamond <- prcomp(diamonds_scaled, scale.=T)
summary(pca_diamond)
rm(list=ls())
library(tidyverse)
f <- function(x) 6*x^2 - 2*x + 4
h <- 0.0001
P2 <- (f(x + h) - f(x))/h
P2 <- (f(2 + h) - f(2))/h
#Q3
P3a <- 50/320
P3b <- 120/320
#Q4
rexp(50,5)
#Q4
wait_times <- rexp(50,5)
wait_times <- wait_times %>% mutate(wait_times_sqrt = sqrt(wait_times))
data <- read.csv("data/Universities.csv")
wait_timesDF <- data.frame(wait_times)
wait_timesDF <- wait_timesDF %>% mutate(wait_times_sqrt=sqrt(wait_times))
ggplot(wait_timesDF, aes(wait_times)) + geom_histogram()
ggplot(wait_timesDF, aes(wait_times_sqrt)) + geom_histogram(bins=10)
ggplot(wait_timesDF, aes(wait_times)) + geom_histogram(bins=10)
ggplot(wait_timesDF, aes(wait_times_sqrt)) + geom_histogram(bins=10)
ggplot(wait_timesDF, aes(wait_times)) + geom_histogram(bins=10)
ggplot(wait_timesDF, aes(wait_times_sqrt)) + geom_histogram(bins=10)
ggplot(wait_timesDF, aes(wait_times)) + geom_histogram(bins=10)
ggplot(wait_timesDF, aes(wait_times_sqrt)) + geom_histogram(bins=10)
ggplot(wait_timesDF, aes(wait_times)) + geom_histogram(bins=10)
ggplot(wait_timesDF, aes(wait_times_sqrt)) + geom_histogram(bins=10)
#Q5
X <- c(5, 7) ; Y <- c(9, 4)
BoundXY <- cbind(X, Y)
BoundXY <- rbind(X, Y)
View(BoundXY)
scale(BoundXY)
P5 <- dist(BoundXY, method="euclidean")
P5
A <- matrix(c(2,1,1,1,3,2,3,4,-5), 3, 3, byrow=T)
A
B <- c(11, 19, -2)
B
P6 <- solve(A,B)
P6 <- solve(A,B) #x=2, y=3, z=4
#Q7
P7a <- 13/20
P7b <- 7/20
#Q8
quadruple_plus_three <- function(x) 4*x + 3
quadruple_plus_three(5)
P8 <- quadruple_plus_three(5)    #23
#Q9
data(txhousing)
#Q9
data("txhousing")
force(txhousing)
#Q9
data(txhousing)
source("~/MathTools/math.R", echo = TRUE)
force(txhousing)
tx.cleaned <- txhousing %>% select(-city,-year,-month,-date)
na.omit(tx.cleaned)
tx.cleaned <- na.omit(tx.cleaned)
tx.scaled <- scale(tx.cleaned)
prcomp(tx.scaled)
pca_tx<-prcomp(tx.scaled)
summary(pca_tx)
P9a <- 0.8083   #0.8083
P9b <- 3        #3 that is PC1, PC2, PC3
#Q10
P10 <- pbinom(4,40,0.12)
#Q11
P11a <- factorial(4)
P11b <- factorial(9)/factorial(6)
